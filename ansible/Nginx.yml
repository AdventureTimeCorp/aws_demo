# web.yml
---
- hosts: all
  remote_user: ubuntu
  gather_facts: False
  tasks:
    - name: install python 2
      raw: test -e /usr/bin/python || (apt -y update && apt install -y python-minimal)
      become: true
  tasks:
    - name: Update apt cache
      apt: update_cache=yes
      become: true

    - name: Install required packages
      apt: name={{ item }}
      become: true
      with_items:
        - nginx
